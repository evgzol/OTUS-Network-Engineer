# Лабораторная работа №4 "Проектирование сети"

## **Задание**
1. Разработаете и задокументируете адресное пространство для лабораторного стенда.
2. Настроите ip адреса на каждом активном порту
3. Настроите каждый VPC в каждом офисе в своем VLAN.
4. Настроите VLAN/Loopbackup interface управления для сетевых устройств
5. Настройте сети офисов так, чтобы не возникало broadcast штормов, а использование линков было максимально оптимизировано

## 1. Разработка и документирование адресного пространства для лабораторного стенда

Схема сети представлена на рисунке ниже:

![Topology.jpg](./img/Topology.jpg)

### Общая идеология разбиения адресного пространства

Считаем, что Москва, Санкт-Петербург, Чокурдак, Лабытнанги --- отделения компании, а Киторн, Ламас, Триада --- провайдеры.

Отделения компании имеют "приватную" адресацию из 10.0.0.0/8, у провайдеров --- "белые" IP-адреса во внешние сети, и "приватные" внутри.

Для отделений компании используем во втором октете автомобильный код региона РФ, а лля внутренней сети провайдеров --- несколько переосмысленный номер AS во втором октете (я художник, я так вижу).

Пользователей разводим по двум VLAN (10 и 20), VLANid для управления --- 100. За это отвечает третий октет.

Для Loopback в третьем октете --- "0", для сетей интерконнекта во внутренних сетях --- "1".

### Таблица распределения адресного пространства

| Net                                                          | Vlan | Name                              | Description     |
|--------------------------------------------------------------|------|-----------------------------------|-----------------|
| 10.77.0.0/16                                                 | -    | Внутренняя сеть                   | Москва          |
| 10.78.0.0/16                                                 | -    |                                   | Санкт-Петербург |
| 10.89.0.0/16                                                 | -    |                                   | Лабытнанги      |
| 10.14.0.0/16                                                 | -    |                                   | Чокудах         |
| 10.111.0.0/16                                                | -    |                                   | Киторн          |
| 10.131.0.0/16                                                | -    |                                   | Ламас           |
| 10.152.0.0/16                                                | -    |                                   | Триада          |
| 10.77.1.0/24                                                 | -    | Пространство для интерконнекта    | Москва          |
| 10.78.1.0/24                                                 | -    |                                   | Санкт-Петербург |
| 10.89.1.0/24                                                 | -    |                                   | Лабытнанги      |
| 10.14.1.0/24                                                 | -    |                                   | Чокудах         |
| 10.111.1.0/24                                                | -    |                                   | Киторн          |
| 10.131.1.0/24                                                | -    |                                   | Ламас           |
| 10.152.1.0/24                                                | -    |                                   | Триада          |
| 10.77.0.0/24                                                 | -    | Пространство для Loopback         | Москва          |
| 10.78.0.0/24                                                 | -    |                                   | Санкт-Петербург |
| 10.89.0.0/24                                                 | -    |                                   | Лабытнанги      |
| 10.14.0.0/24                                                 | -    |                                   | Чокудах         |
| 10.111.0.0/24                                                | -    |                                   | Киторн          |
| 10.131.0.0/24                                                | -    |                                   | Ламас           |
| 10.152.0.0/24                                                | -    |                                   | Триада          |
| 111.111.111.0/24                                             | -    | Внешняя сеть                      | Киторн          |
| 131.131.131.0/24                                             | -    |                                   | Ламас           |
| 152.152.152.0/24                                             | -    |                                   | Триада          |
| 10.77.10.0/24                                                | 10   | VLAN10, пользователи              | Москва          |
| 10.78.10.0/24                                                | 10   |                                   | Санкт-Петербург |
| 10.14.10.0/24                                                | 10   |                                   | Чокудах         |
| 10.77.20.0/24                                                | 20   | VLAN20, пользователи              | Москва          |
| 10.78.20.0/24                                                | 20   |                                   | Санкт-Петербург |
| 10.14.20.0/24                                                | 20   |                                   | Чокудах         |
| 10.77.100.0/24                                               | 100  | VLAN100, управление коммутаторами | Москва          |
| 10.78.100.0/24                                               | 100  |                                   | Санкт-Петербург |
| 10.14.100.0/24                                               | 100  |                                   | Чокудах         |

Для сетей интерконнекты будем испольлзовать /30-ые подсети.

Столбец Description будем испольлзовать для описания при настройке интерфейсов на сетевых элементах.

Теперь распределим IP-адреса по сетевым элементам, согласно приведённых выше принципов.

### Таблица распределения IP-адресов

HostName|Loopback|Port|IP-address|Network|Location|Description|Комментарий
---|---|---|---|---|---|---|---
R12|10.77.0.12|e0/0|10.77.1.25/30|10.77.1.24/30|Москва|***\_to\_SW4\_(e1/0)|
R12|10.77.0.12|e0/1|10.77.1.29/30|10.77.1.28/30|Москва|***\_to\_SW5\_(e1/1)|
R12|10.77.0.12|e0/2|10.77.1.6/30|10.77.1.4/30|Москва|***\_to\_R14\_(e0/0)|
R12|10.77.0.12|e0/3|10.77.1.14/30|10.77.1.12/30|Москва|***\_to\_R15\_(e1/1)|
R13|10.77.0.13|e0/0|10.77.1.37/30|10.77.1.36/30|Москва|***\_to\_SW5\_(e1/0)|
R13|10.77.0.13|e0/1|10.77.1.33/30|10.77.1.32/30|Москва|***\_to\_SW4\_(e1/1)|
R13|10.77.0.13|e0/2|10.77.1.18/30|10.77.1.16/30|Москва|***\_to\_R15\_(e0/0)|
R13|10.77.0.13|e0/3|10.77.1.10/30|10.77.1.8/30|Москва|***\_to\_R14\_(e0/1)|
R14|10.77.0.14|e0/0|10.77.1.5/30|10.77.1.4/30|Москва|***\_to\_R12\_(e0/2)|
R14|10.77.0.14|e0/1|10.77.1.9/30|10.77.1.8/30|Москва|***\_to\_R13\_(e0/3)|
R14|10.77.0.14|e0/2|111.111.111.2/30|111.111.111.0/30|Москва|***\_to\_R22\_(e0/0)\_Kitorn|
R14|10.77.0.14|e0/3|10.77.1.1/30|10.77.1.0/30|Москва|***\_to\_R19\_(e0/0)|
R15|10.77.0.15|e0/0|10.77.1.17/30|10.77.1.16/30|Москва|***\_to\_R13\_(e0/2)|
R15|10.77.0.15|e0/1|10.77.1.13/30|10.77.1.12/30|Москва|***\_to\_R12\_(e0/3)|
R15|10.77.0.15|e0/2|131.131.131.2/30|131.131.131.0/30|Москва|***\_to\_R21\_(e0/0)\_Lamas|
R15|10.77.0.15|e0/3|10.77.1.1/30|10.77.1.0/30|Москва|***\_to\_R19\_(e0/0)|
R19|10.77.0.19|e0/0|10.77.1.2/30|10.77.1.0/30|Москва|***\_to\_R14\_(e0/3)|
R20|10.77.0.20|e0/0|10.77.1.22/30|10.77.1.20/30|Москва|***\_to\_R15\_(e0/3)|
SW4||e0/1|10.77.1.26/30|10.77.1.24/30|Москва|***\_to\_R12\_(e0/0)|
SW4||e0/2|10.77.1.34/30|10.77.1.32/30|Москва|***\_to\_R13\_(e0/1)|
SW5||e0/1|10.77.1.38/30|10.77.1.36/30|Москва|***\_to\_R13\_(e0/0)|
SW5||e0/2|10.77.1.30/30|10.77.1.28/30|Москва|***\_to\_R12\_(e0/1)|
R16|10.78.0.16|e0/0|-|-|Санкт-Петербург|***\_to\_SW10\_(e0/3)|
R16|10.78.0.16|e0/1|10.78.1.6/30|10.78.1.4/30|Санкт-Петербург|***\_to\_R18\_(e0/0)|
R16|10.78.0.16|e0/2|-|-|Санкт-Петербург|***\_to\_SW9\_(e1/0)|
R16|10.78.0.16|e0/3|10.78.1.9/30|10.78.1.8/30|Санкт-Петербург|***\_to\_R32\_(e0/0)|
R17|10.78.0.17|e0/0|-|-|Санкт-Петербург|***\_to\_SW9\_(e0/3)|
R17|10.78.0.17|e0/1|10.78.1.2/30|10.78.1.0/30|Санкт-Петербург|***\_to\_R18\_(e0/1)|
R17|10.78.0.17|e0/2|-|-|Санкт-Петербург|***\_to\_SW10\_(e1/0)|
R18|10.78.0.18|e0/0|10.78.1.5/30|10.78.1.4/30|Санкт-Петербург|***\_to\_R16\_(e0/1)|
R18|10.78.0.18|e0/1|10.78.1.1/30|10.78.1.0/30|Санкт-Петербург|***\_to\_R17\_(e0/1)|
R18|10.78.0.18|e0/2|152.152.152.2/30|152.152.152.0/30|Санкт-Петербург|***\_to\_R24\_(e0/3)\_Triada|
R18|10.78.0.18|e0/3|152.152.152.6/30|152.152.152.4/30|Санкт-Петербург|***\_to\_R26\_(e0/3)\_Triada|
R27|10.89.0.27|e0/0|152.152.152.18/30|152.152.152.16/30|Лабытнанги|***\_to\_R27\_(e0/1)\_Triada|
R28|10.14.0.28|e0/0|152.152.152.10/30|152.152.152.8/30|Чокудах|***\_to\_R26\_(e0/1)\_Triada|
R28|10.14.0.28|e0/1|152.152.152.14/30|152.152.152.12/30|Чокудах|***\_to\_R25\_(e0/3)\_Triada|
R28|10.14.0.28|e0/2|-|-|Чокудах|***\_to\_SW29\_(e0/2)|
R22|10.111.0.22|e0/0|111.111.111.1/30|111.111.111.0/30|Киторн\_(провайдер)|***\_to\_R14\_(e0/2)\_MSK|
R22|10.111.0.22|e0/1|111.111.111.5/30|111.111.111.4/30|Киторн\_(провайдер)|***\_to\_R21\_(e0/1)\_Lamas|
R22|10.111.0.22|e0/2|111.111.111.9/30|111.111.111.8/30|Киторн\_(провайдер)|***\_to\_R23\_(e0/0)\_Triada|
R21|10.131.0.21|e0/0|131.131.131.1/30|131.131.131.0/30|Ламас\_(провайдер)|***\_to\_R15\_(e0/2)\_MSK|
R21|10.131.0.21|e0/1|111.111.111.6/30|111.111.111.4/30|Ламас\_(провайдер)|***\_to\_R22\_(e0/1)\_Kitorn|
R21|10.131.0.21|e0/2|131.131.131.5/30|131.131.131.4/30|Ламас\_(провайдер)|***\_to\_R24\_(e0/0)\_Triada|
R23|10.152.0.23|e0/0|111.111.111.10/30|111.111.111.8/30|Триада\_(провайдер)|***\_to\_R22\_(e0/2)\_Kitorn|
R23|10.152.0.23|e0/1|10.152.1.5/30|10.152.1.4/30|Триада\_(провайдер)|***\_to\_R25\_(e0/0)|
R23|10.152.0.23|e0/2|10.152.1.1/30|10.152.1.0/30|Триада\_(провайдер)|***\_to\_R24\_(e0/2)|
R24|10.152.0.24|e0/0|131.131.131.6/30|131.131.131.4/30|Триада\_(провайдер)|***\_to\_R21\_(e0/2)\_Lamas|
R24|10.152.0.24|e0/1|10.152.1.13/30|10.152.1.12/30|Триада\_(провайдер)|***\_to\_R26\_(e0/0)|
R24|10.152.0.24|e0/2|10.152.1.2/30|10.152.1.0/30|Триада\_(провайдер)|***\_to\_R23\_(e0/2)|
R24|10.152.0.24|e0/3|152.152.152.1/30|152.152.152.0/30|Триада\_(провайдер)|***\_to\_R18\_(e0/2)\_SPB|
R25|10.152.0.25|e0/0|10.152.1.6/30|10.152.1.4/30|Триада\_(провайдер)|***\_to\_R23(e0/1)|
R25|10.152.0.25|e0/1|152.152.152.17/30|152.152.152.16/30|Триада\_(провайдер)|***\_to\_R27\_(e0/0)\_LBT|
R25|10.152.0.25|e0/2|10.152.1.9/30|10.152.1.8/30|Триада\_(провайдер)|***\_to\_R26\_(e0/2)|
R25|10.152.0.25|e0/3|152.152.152.13/30|152.152.152.12/30|Триада\_(провайдер)|***\_to\_R28\_(e0/1)\_CHK|
R26|10.152.0.26|e0/0|10.152.1.14/30|10.152.1.12/30|Триада\_(провайдер)|***\_to\_R24\_(e0/1)|
R26|10.152.0.26|e0/1|152.152.152.9/30|152.152.152.8/30|Триада\_(провайдер)|***\_to\_R28\_(e0/0)\_CHK|
R26|10.152.0.26|e0/2|10.152.1.10/30|10.152.1.8/30|Триада\_(провайдер)|***\_to\_R25\_(e0/2)|
R26|10.152.0.26|e0/3|152.152.152.5/30|152.152.152.4/30|Триада\_(провайдер)|***\_to\_R18\_(e0/3)\_SPB|
VPC1|-|eth0|10.77.10.1/24|10.77.10.0/24|Москва||VLAN10
VPC7|-|eth0|10.77.20.7/24|10.77.20.0/24|Москва||VLAN20
VPC8|-|eth0|10.78.10.8/24|10.78.10.0/24|Санкт-Петербург||VLAN10
VPC11|-|eth0|10.78.20.11/24|10.78.20.0/24|Санкт-Петербург||VLAN20
VPC30|-|eth0|10.14.10.30/24|10.14.10.0/24|Чокудах||VLAN10
VPC31|-|eth0|10.14.20.31/24|10.14.20.0/24|Чокудах||VLAN20
SW2|-|Vlan100|10.77.100.2/24|10.77.100.0/24|Москва||VLAN100
SW3|-|Vlan100|10.77.100.3/24|10.77.100.0/24|Москва||VLAN100
SW4|-|Vlan100|10.77.100.4/24|10.77.100.0/24|Москва||VLAN100
SW5|-|Vlan100|10.77.100.5/24|10.77.100.0/24|Москва||VLAN100
SW9|-|Vlan100|10.78.100.9/24|10.78.100.0/24|Санкт-Петербург||VLAN100
SW10|-|Vlan100|10.78.100.10/24|10.78.100.0/24|Санкт-Петербург||VLAN100
SW29|-|Vlan100|10.14.100.29/24|10.14.100.0/24|Чокудах||VLAN100

Для удобства, нанёс IP-адреса на схему сети. 

![Topology-with-IP.jpg](./img/Topology-with-IP.jpg)

## 2. РНастройка IP-адреса на каждом активном порту

Все настройки не привожу, пример настроек для маршрутизаторов (на примере R12):
  ```
  interface Ethernet0/0
   ip address 10.77.1.25 255.255.255.252
  end
  ```
и коммутаторов (на примере SW4):
  ```
  interface Ethernet1/0
   no switchport
   ip address 10.77.1.26 255.255.255.252
   duplex auto
  end
  ```

